<!-- Task Card Component -->
<a href="{{ url_for('tasks.task_detail', task_id=task.id) }}"
   class="block bg-white rounded-xl border-2 border-gray-200 p-4 hover:border-gray-900 transition-all group">

  <!-- Priority & Overdue Indicator -->
  <div class="flex items-center gap-2 mb-3">
    {% if task.priority == 'urgent' %}
    <span class="inline-block w-2 h-2 bg-red-600 rounded-full"></span>
    {% elif task.priority == 'high' %}
    <span class="inline-block w-2 h-2 bg-orange-500 rounded-full"></span>
    {% elif task.priority == 'low' %}
    <span class="inline-block w-2 h-2 bg-blue-500 rounded-full"></span>
    {% else %}
    <span class="inline-block w-2 h-2 bg-gray-400 rounded-full"></span>
    {% endif %}

    <span class="text-xs font-bold text-gray-600">{{ task.task_no }}</span>

    {% if task.is_overdue %}
    <span class="ml-auto text-xs font-bold text-red-600 animate-pulse">⚠️</span>
    {% endif %}
  </div>

  <!-- Title -->
  <h4 class="font-bold text-gray-900 text-sm mb-2 line-clamp-2 group-hover:text-gray-700">
    {{ task.title }}
  </h4>

  <!-- Meta Info -->
  <div class="space-y-2 text-xs text-gray-500">
    {% if task.due_date %}
    <div class="flex items-center gap-1.5">
      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      <span class="font-semibold">
        {{ task.due_date.strftime('%b %d') }}
        {% if task.days_until_due is not none and task.days_until_due <= 3 and task.days_until_due >= 0 %}
          <span class="text-amber-600">({{ task.days_until_due }}d)</span>
        {% endif %}
      </span>
    </div>
    {% endif %}

    {% if task.requester %}
    <div class="flex items-center gap-1.5">
      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
      </svg>
      <span class="font-semibold truncate">{{ task.requester }}</span>
    </div>
    {% endif %}

    {% if task.related_supplier %}
    <div class="flex items-center gap-1.5">
      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
      </svg>
      <span class="font-semibold truncate">{{ task.related_supplier }}</span>
    </div>
    {% endif %}
  </div>

  <!-- Progress Bar -->
  {% if task.progress > 0 %}
  <div class="mt-3">
    <div class="flex items-center justify-between mb-1">
      <span class="text-xs font-bold text-gray-600">{{ task.progress }}%</span>
    </div>
    <div class="h-1.5 bg-gray-200 rounded-full overflow-hidden">
      <div class="h-full bg-gray-900 rounded-full transition-all"
           style="width: {{ task.progress }}%"></div>
    </div>
  </div>
  {% endif %}

</a>